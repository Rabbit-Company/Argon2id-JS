/*
Blake2b-JS v1.0.0
https://github.com/Rabbit-Company/Blake2b-JS
License: GPL-3.0
*/
class Blake2b{v=new Uint32Array(32);m=new Uint32Array(32);BLAKE2B_IV32=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]);SIGMA8=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3];parameterBlock=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);SIGMA82=new Uint8Array(this.SIGMA8.map(function(t){return 2*t}));ADD64AA(t,_,$){let e=t[_]+t[$],i=t[_+1]+t[$+1];e>=4294967296&&i++,t[_]=e,t[_+1]=i}ADD64AC(t,_,$,e){let i=t[_]+$;$<0&&(i+=4294967296);let h=t[_+1]+e;i>=4294967296&&h++,t[_]=i,t[_+1]=h}B2B_GET32(t,_){return t[_]^t[_+1]<<8^t[_+2]<<16^t[_+3]<<24}B2B_G(t,_,$,e,i,h){let s=this.m[i],l=this.m[i+1],r=this.m[h],a=this.m[h+1];this.ADD64AA(this.v,t,_),this.ADD64AC(this.v,t,s,l);let n=this.v[e]^this.v[t],A=this.v[e+1]^this.v[t+1];this.v[e]=A,this.v[e+1]=n,this.ADD64AA(this.v,$,e),n=this.v[_]^this.v[$],A=this.v[_+1]^this.v[$+1],this.v[_]=n>>>24^A<<8,this.v[_+1]=A>>>24^n<<8,this.ADD64AA(this.v,t,_),this.ADD64AC(this.v,t,r,a),n=this.v[e]^this.v[t],A=this.v[e+1]^this.v[t+1],this.v[e]=n>>>16^A<<16,this.v[e+1]=A>>>16^n<<16,this.ADD64AA(this.v,$,e),n=this.v[_]^this.v[$],A=this.v[_+1]^this.v[$+1],this.v[_]=A>>>31^n<<1,this.v[_+1]=n>>>31^A<<1}blake2bCompress(t,_){let $=0;for($=0;$<16;$++)this.v[$]=t.h[$],this.v[$+16]=this.BLAKE2B_IV32[$];for(this.v[24]=this.v[24]^t.t,this.v[25]=this.v[25]^t.t/4294967296,_&&(this.v[28]=~this.v[28],this.v[29]=~this.v[29]),$=0;$<32;$++)this.m[$]=this.B2B_GET32(t.b,4*$);for($=0;$<12;$++)this.B2B_G(0,8,16,24,this.SIGMA82[16*$+0],this.SIGMA82[16*$+1]),this.B2B_G(2,10,18,26,this.SIGMA82[16*$+2],this.SIGMA82[16*$+3]),this.B2B_G(4,12,20,28,this.SIGMA82[16*$+4],this.SIGMA82[16*$+5]),this.B2B_G(6,14,22,30,this.SIGMA82[16*$+6],this.SIGMA82[16*$+7]),this.B2B_G(0,10,20,30,this.SIGMA82[16*$+8],this.SIGMA82[16*$+9]),this.B2B_G(2,12,22,24,this.SIGMA82[16*$+10],this.SIGMA82[16*$+11]),this.B2B_G(4,14,16,26,this.SIGMA82[16*$+12],this.SIGMA82[16*$+13]),this.B2B_G(6,8,18,28,this.SIGMA82[16*$+14],this.SIGMA82[16*$+15]);for($=0;$<16;$++)t.h[$]=t.h[$]^this.v[$]^this.v[$+16]}blake2bInit(t,_,$,e){if(0===t||t>64)throw Error("Illegal output length, expected 0 < length <= 64");if(_&&_.length>64)throw Error("Illegal key, expected Uint8Array with 0 < length <= 64");if($&&16!==$.length)throw Error("Illegal salt, expected Uint8Array with length is 16");if(e&&16!==e.length)throw Error("Illegal personal, expected Uint8Array with length is 16");let i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};this.parameterBlock.fill(0),this.parameterBlock[0]=t,_&&(this.parameterBlock[1]=_.length),this.parameterBlock[2]=1,this.parameterBlock[3]=1,$&&this.parameterBlock.set($,32),e&&this.parameterBlock.set(e,48);for(let h=0;h<16;h++)i.h[h]=this.BLAKE2B_IV32[h]^this.B2B_GET32(this.parameterBlock,4*h);return _&&(this.blake2bUpdate(i,_),i.c=128),i}blake2bUpdate(t,_){for(let $=0;$<_.length;$++)128===t.c&&(t.t+=t.c,this.blake2bCompress(t,!1),t.c=0),t.b[t.c++]=_[$]}blake2bFinal(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;this.blake2bCompress(t,!0);let _=new Uint8Array(t.outlen);for(let $=0;$<t.outlen;$++)_[$]=t.h[$>>2]>>8*(3&$);return _}blake2bStart(t,_,$,e,i){$=$||64,t=this.normalizeInput(t),e&&(e=this.normalizeInput(e)),i&&(i=this.normalizeInput(i));let h=this.blake2bInit($,_,e,i);return this.blake2bUpdate(h,t),this.blake2bFinal(h)}blake2bHex(t,_,$,e,i){let h=blake2bStart(t,_,$,e,i);return toHex(h)}normalizeInput(t){let _;if(t instanceof Uint8Array)_=t;else if("string"==typeof t){let $=new TextEncoder;_=$.encode(t)}else throw Error("Input must be an string, Buffer or Uint8Array");return _}toHex(t){return Array.prototype.map.call(t,function(t){return(t<16?"0":"")+t.toString(16)}).join("")}static hash(t,_,$=64,e,i){let h=new Blake2b,s=h.blake2bStart(t,_,$,e,i);return h.toHex(s)}}
/*
Argon2id-JS v1.0.0
https://github.com/Rabbit-Company/Argon2id-JS
License: GPL-3.0
*/
class Argon2id{static memo={};construtor(){this.mm=NaN;this.H_0=NaN;this.p=NaN;this.q=NaN}LE32(t){let e=new Uint8Array(4);e[0]=t;e[1]=t>>8&255;e[2]=t>>16&255;e[3]=t>>24&255;return Array.from(e)}LE64(t){let e=new Uint8Array(8);e[0]=t;e[1]=t>>8&255;e[2]=t>>16&255;e[3]=t>>24&255;return Array.from(e)}toHex(t){return Array.prototype.map.call(t,function(t){return(t<16?"0":"")+t.toString(16)}).join("")}ascii(t){var e=[];for(var i=0,n=t.length;i<n;i++){var r=Number(t.charCodeAt(i));e.push(r)}return e}extract(t,e){if(e==0)return this.Uint8ArrayToBigInt(t.slice(0,4));if(e==1)return this.Uint8ArrayToBigInt(t.slice(4,8))}NumberToUint8Array(e){var i=[];let n=Math.ceil(Math.floor(Math.log2(new Number(e))+1)/8);for(let t=0;t<n;t++){i.unshift(new Number(e&255n));e>>=8n}return new Uint8Array(i).reverse()}Uint8ArrayToBigInt(e){let i=0n;for(let t=e.length-1;t>=0;t--){i=BigInt(e[t])|i<<8n}return i}ZERO(t){return new Uint8Array(t)}Concatenate(...t){let e=0;t.forEach(t=>{e+=t.length});const i=new Uint8Array(e);let n=0;t.forEach(t=>{i.set(t,n);n+=t.length});return i}XOR(e,i){let n=new Uint8Array(1024);for(let t=0;t<e.length;t++)n[t]=e[t]^i[t];return n}MOD(t,e){return(t%e+e)%e}GB(t,e,i,n){const r=2n**64n-1n;let a=BigInt(4294967295);t=t+e+BigInt(2)*(t&a)*(e&a)&BigInt.asUintN(64,r);let s=n^t;n=s>>BigInt(32)|(s&a)<<BigInt(32);i=i+n+BigInt(2)*(i&a)*(n&a)&BigInt.asUintN(64,r);s=e^i;e=s>>BigInt(24)|(s&BigInt(16777215))<<BigInt(40);t=t+e+BigInt(2)*(t&a)*(e&a)&BigInt.asUintN(64,r);s=n^t;n=s>>BigInt(16)|(s&BigInt(65535))<<BigInt(48);i=i+n+BigInt(2)*(i&a)*(n&a)&BigInt.asUintN(64,r);s=e^i;e=s>>BigInt(63)|s<<BigInt(1)&BigInt.asUintN(64,r);return[t,e,i,n]}P(t,e,i,n,r,a,s,l){let h;let o=this.Uint8ArrayToBigInt(t.slice(0,8));let c=this.Uint8ArrayToBigInt(t.slice(8,16));let g=this.Uint8ArrayToBigInt(e.slice(0,8));let f=this.Uint8ArrayToBigInt(e.slice(8,16));let u=this.Uint8ArrayToBigInt(i.slice(0,8));let b=this.Uint8ArrayToBigInt(i.slice(8,16));let A=this.Uint8ArrayToBigInt(n.slice(0,8));let m=this.Uint8ArrayToBigInt(n.slice(8,16));let B=this.Uint8ArrayToBigInt(r.slice(0,8));let y=this.Uint8ArrayToBigInt(r.slice(8,16));let U=this.Uint8ArrayToBigInt(a.slice(0,8));let E=this.Uint8ArrayToBigInt(a.slice(8,16));let I=this.Uint8ArrayToBigInt(s.slice(0,8));let d=this.Uint8ArrayToBigInt(s.slice(8,16));let w=this.Uint8ArrayToBigInt(l.slice(0,8));let p=this.Uint8ArrayToBigInt(l.slice(8,16));let N=this.GB(o,u,B,I);o=N[0];u=N[1];B=N[2];I=N[3];N=this.GB(c,b,y,d);c=N[0];b=N[1];y=N[2];d=N[3];N=this.GB(g,A,U,w);g=N[0];A=N[1];U=N[2];w=N[3];N=this.GB(f,m,E,p);f=N[0];m=N[1];E=N[2];p=N[3];N=this.GB(o,b,U,p);o=N[0];b=N[1];U=N[2];p=N[3];N=this.GB(c,A,E,I);c=N[0];A=N[1];E=N[2];I=N[3];N=this.GB(g,m,B,d);g=N[0];m=N[1];B=N[2];d=N[3];N=this.GB(f,u,y,w);f=N[0];u=N[1];y=N[2];w=N[3];o=this.NumberToUint8Array(o);c=this.NumberToUint8Array(c);g=this.NumberToUint8Array(g);f=this.NumberToUint8Array(f);u=this.NumberToUint8Array(u);b=this.NumberToUint8Array(b);A=this.NumberToUint8Array(A);m=this.NumberToUint8Array(m);B=this.NumberToUint8Array(B);y=this.NumberToUint8Array(y);U=this.NumberToUint8Array(U);E=this.NumberToUint8Array(E);I=this.NumberToUint8Array(I);d=this.NumberToUint8Array(d);w=this.NumberToUint8Array(w);p=this.NumberToUint8Array(p);if(o.length<8){h=8-o.length;o=this.Concatenate(o,this.ZERO(h))}if(c.length<8){h=8-c.length;c=this.Concatenate(c,this.ZERO(h))}if(g.length<8){h=8-g.length;g=this.Concatenate(g,this.ZERO(h))}if(f.length<8){h=8-f.length;f=this.Concatenate(f,this.ZERO(h))}if(u.length<8){h=8-u.length;u=this.Concatenate(u,this.ZERO(h))}if(b.length<8){h=8-b.length;b=this.Concatenate(b,this.ZERO(h))}if(A.length<8){h=8-A.length;A=this.Concatenate(A,this.ZERO(h))}if(m.length<8){h=8-m.length;m=this.Concatenate(m,this.ZERO(h))}if(B.length<8){h=8-B.length;B=this.Concatenate(B,this.ZERO(h))}if(y.length<8){h=8-y.length;y=this.Concatenate(y,this.ZERO(h))}if(U.length<8){h=8-U.length;U=this.Concatenate(U,this.ZERO(h))}if(E.length<8){h=8-E.length;E=this.Concatenate(E,this.ZERO(h))}if(I.length<8){h=8-I.length;I=this.Concatenate(I,this.ZERO(h))}if(d.length<8){h=8-d.length;d=this.Concatenate(d,this.ZERO(h))}if(w.length<8){h=8-w.length;w=this.Concatenate(w,this.ZERO(h))}if(p.length<8){h=8-p.length;p=this.Concatenate(p,this.ZERO(h))}t=this.Concatenate(o,c);e=this.Concatenate(g,f);i=this.Concatenate(u,b);n=this.Concatenate(A,m);r=this.Concatenate(B,y);a=this.Concatenate(U,E);s=this.Concatenate(I,d);l=this.Concatenate(w,p);return[t,e,i,n,r,a,s,l]}G(h,o){return new Promise(t=>{let e=this.XOR(h,o);let i=[];let n;let r;let a;for(let t=0;t<8;t++){r=128*t;n=this.P(e.slice(r,r+16),e.slice(r+16,r+32),e.slice(r+32,r+48),e.slice(r+48,r+64),e.slice(r+64,r+80),e.slice(r+80,r+96),e.slice(r+96,r+112),e.slice(r+112,r+128));n.forEach(t=>i.push(...t))}let s=[];for(let t=0;t<8;t++){r=16*t;n=this.P(i.slice(r,r+16),i.slice(r+128,r+128+16),i.slice(r+256,r+256+16),i.slice(r+384,r+384+16),i.slice(r+512,r+512+16),i.slice(r+640,r+640+16),i.slice(r+768,r+768+16),i.slice(r+896,r+896+16));n.forEach(t=>i.push(...t));for(let t=0;t<n.length;t++)s=this.Concatenate(s,n[t])}let l=[];for(let t=0;t<8;t++){r=16*t;l=this.Concatenate(l,s.slice(r,r+16),s.slice(r+128,r+128+16),s.slice(r+256,r+256+16),s.slice(r+384,r+384+16),s.slice(r+512,r+512+16),s.slice(r+640,r+640+16),s.slice(r+768,r+768+16),s.slice(r+896,r+896+16))}t(this.XOR(l,e))})}blake2bSetup(t,e=null){this.context=(new Blake2b).blake2bInit(t,e)}async Argon2Operation(o,t,e,c,g,f,i,n,r="",a=""){const u=this.EstablishH_0(o,t,e,c,g,f,i,n,r,a);this.AllocateMemory(o,e);const b=this.mm/o;var A=b/4;let m=Array.from(Array(Number(o)),()=>[]);if(window.Worker&&window.runWorker){const B=[];await new Promise(n=>{let r=0,a=0,s=0,t=[];const l=()=>{B.forEach((t,e)=>{t.postMessage({type:"fill-segment",payload:{B:m,t:r,segment:a,i:Number(e),y:f,segment_Length:A,H_0:u,q:b,p:Number(o),mm:this.mm,time_cost:c,v:g}})})};const h=()=>{B.forEach(t=>t.terminate())};for(let t=0;t<o;t++){B[t]=new Worker(URL.createObjectURL(new Blob(["("+runWorker.toString()+")()"],{type:"text/javascript"})));B[t].onmessage=function(e){const{i}=e.data.payload;s++;for(let t=0;t<A;t++)m[i][a*A+t]=e.data.result[t];if(s>=o){s=0;a++;if(a>=4){a=0;r++;if(r>=c){h();return n()}}l()}}}l()})}else{for(let n=0;n<c;n++){for(let i=0;i<4;i++){var s=await Promise.all(Array.from(Array(Number(o)),(t,e)=>this._fill_segment(m,n,i,e,f,A,u,b,o,this.mm,c,g)));for(let e=0;e<o;e++){var l=s[e];for(let t=0;t<A;t++)m[e][i*A+t]=l[t]}}}}let h=this.ZERO(1024);for(let t=0;t<o;t++)h=this.XOR(h,m[t][b-1]);return this.variableLengthHashFunction(t,h)}EstablishH_0(t,e,i,n,r,a,s,l,h="",o=""){var c=this.Concatenate(this.LE32(t),this.LE32(e),this.LE32(i),this.LE32(n),this.LE32(r),this.LE32(a),this.LE32(s.length),this.ascii(s),this.LE32(l.length),this.ascii(l),this.LE32(h.length),this.ascii(h),this.LE32(o.length),this.ascii(o));this.blake2bSetup(64);(new Blake2b).blake2bUpdate(this.context,c);return(new Blake2b).blake2bFinal(this.context)}AllocateMemory(t,e){let i=4*t*Math.floor(e/(4*t));this.mm=i}getHash(t,e,i){const n="hash"+t+"_"+e+"_"+i;if(Argon2id.memo[n]){return Argon2id.memo[n]}const r=this.variableLengthHashFunction(1024,this.Concatenate(t,this.LE32(e),this.LE32(i)));Argon2id.memo[n]=r;return r}variableLengthHashFunction(t,e){if(t<=64){this.blake2bSetup(t);n=this.Concatenate(this.LE32(t),e);(new Blake2b).blake2bUpdate(this.context,n);return(new Blake2b).blake2bFinal(this.context)}else{var i=Math.ceil(t/32)-2;var n=this.Concatenate(this.LE32(t),e);this.blake2bSetup(64);(new Blake2b).blake2bUpdate(this.context,n);var r=(new Blake2b).blake2bFinal(this.context);var a=r.slice(0,32);for(let t=2;t<=i;t++){this.blake2bSetup(64);(new Blake2b).blake2bUpdate(this.context,r);r=(new Blake2b).blake2bFinal(this.context);a=this.Concatenate(a,r.slice(0,32))}var s=t-32*i;this.blake2bSetup(s);(new Blake2b).blake2bUpdate(this.context,r);r=(new Blake2b).blake2bFinal(this.context);return this.Concatenate(a,r)}}async getAddressBlock(t,e,i,n,r,a,s){const l=`${t}_${e}_${i}_${n}_${r}_${a}_${s}`;if(Argon2id.memo[l]){return Argon2id.memo[l]}const h=this.Concatenate(this.LE64(t),this.LE64(e),this.LE64(i),this.LE64(n),this.LE64(r),this.LE64(a),this.LE64(s),this.ZERO(968));const o=await this.G(this.ZERO(1024),await this.G(this.ZERO(1024),h));Argon2id.memo[l]=o;return o}async _fill_segment(e,i,n,r,t,a,s,l,h,o,c,g){var f=t==1||t==2&&i==0&&n<=1;if(f){var u=[];var b=0;while(u.length<a){b+=1;const p=await this.getAddressBlock(i,r,n,o,c,t,b);for(let t=0;t<1024;t+=8)u.push([this.Uint8ArrayToBigInt(p.slice(t,t+4)),this.Uint8ArrayToBigInt(p.slice(t+4,t+8))])}}for(let t=0;t<a;t++){var A=n*a+t;if(i==0&&A<2){e[r][A]=this.getHash(s,A,r);continue}var m=NaN;var B=NaN;if(f){m=u[t][0];B=u[t][1]}else{m=this.extract(e[r][this.MOD(A-1,l)],0);B=this.extract(e[r][this.MOD(A-1,l)],1)}var y=NaN;if(i==0&&n==0){y=r}else{y=this.MOD(B,BigInt(h))}var U=NaN;if(i==0){if(n==0||r==y){U=A-1}else if(t==0){U=n*a-1}else{U=n*a}}else if(r==y){U=l-a+t-1}else if(t==0){U=l-a-1}else{U=l-a}var E=m**BigInt(2)>>BigInt(32);E=BigInt(U)-BigInt(1)-(BigInt(U)*E>>BigInt(32));var I=0;if(i!=0&&n!=3)I=(n+1)*a;var d=this.MOD(BigInt(I)+E,BigInt(l));var w=await this.G(e[r][this.MOD(A-1,l)],e[y][d]);if(i!=0&&g==19)w=this.XOR(e[r][A],w);e[r][A]=w}return e[r].slice(n*a,(n+1)*a)}hexToBase64(t){return btoa(t.match(/\w{2}/g).map(function(t){return String.fromCharCode(parseInt(t,16))}).join(""))}base64ToHex(t){const e=atob(t);let i="";for(let t=0;t<e.length;t++){const n=e.charCodeAt(t).toString(16);i+=n.length===2?n:"0"+n}return i.toUpperCase()}randRange(t,e){var i=e-t;var n=Math.ceil(Math.log2(i)/8);if(!n)return t;var r=Math.pow(256,n);var a=new Uint8Array(n);while(true){window.crypto.getRandomValues(a);var s=0;for(var l=0;l<n;l++)s=(s<<8)+a[l];if(s<r-r%i)return t+s%i}}static randomSalt(){let e=new Argon2id;let i=16;let n="abcdefghijklmnopqrstuvwxyz";let r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let a="1234567890";let s="";for(let t=0;t<i;t++)s+=n.charAt(e.randRange(0,n.length));s=s.split("");for(let t=0;t<i/2;t++)s[e.randRange(0,s.length)]=r.charAt(e.randRange(0,r.length));for(let t=0;t<i/2;t++)s[e.randRange(0,s.length)]=a.charAt(e.randRange(0,a.length));return s.join("")}static async hash(t,e=Argon2id.randomSalt(),i=2,n=32,r=3,a=32,s="",l=""){let h=new Argon2id;let o=await h.Argon2Operation(r,a,n,i,19,2,t,e,s,l);return h.toHex(o)}static hashDecode(t){let e=new Argon2id;let i=t.split("$")[5];return e.base64ToHex(i).toLowerCase()}static hashEncoded(t,n=Argon2id.randomSalt(),r=2,a=32,s=3,l=32,h="",o=""){return new Promise(e=>{let i=new Argon2id;i.Argon2Operation(s,l,a,r,19,2,t,n,h,o).then(t=>{e("$argon2id$v=19$m="+a+",t="+r+",p="+s+"$"+btoa(n).replaceAll("=","")+"$"+i.hexToBase64(i.toHex(t)).replaceAll("=",""))})})}static verify(t,i,n="",r=""){let e=t.split("$");if(e.length!=6)return false;if(e[1]!="argon2id")return false;if(e[2]!="v=19")return false;let a=e[3].split(",");if(a.length!=3)return false;let s=a[0].split("=")[1];let l=a[1].split("=")[1];let h=a[2].split("=")[1];let o=atob(e[4]);let c=Argon2id.hashDecode(t);return new Promise(e=>{Argon2id.hash(i,o,l,s,h,c.length/2,n,r).then(t=>{e(c==t)})})}}