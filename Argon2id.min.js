/*
Blake2b-JS v1.0.0
https://github.com/Rabbit-Company/Blake2b-JS
License: GPL-3.0
*/
class Blake2b{v=new Uint32Array(32);m=new Uint32Array(32);BLAKE2B_IV32=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]);SIGMA8=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3];parameterBlock=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);SIGMA82=new Uint8Array(this.SIGMA8.map(function(t){return 2*t}));ADD64AA(t,_,$){let e=t[_]+t[$],i=t[_+1]+t[$+1];e>=4294967296&&i++,t[_]=e,t[_+1]=i}ADD64AC(t,_,$,e){let i=t[_]+$;$<0&&(i+=4294967296);let h=t[_+1]+e;i>=4294967296&&h++,t[_]=i,t[_+1]=h}B2B_GET32(t,_){return t[_]^t[_+1]<<8^t[_+2]<<16^t[_+3]<<24}B2B_G(t,_,$,e,i,h){let s=this.m[i],l=this.m[i+1],r=this.m[h],a=this.m[h+1];this.ADD64AA(this.v,t,_),this.ADD64AC(this.v,t,s,l);let n=this.v[e]^this.v[t],A=this.v[e+1]^this.v[t+1];this.v[e]=A,this.v[e+1]=n,this.ADD64AA(this.v,$,e),n=this.v[_]^this.v[$],A=this.v[_+1]^this.v[$+1],this.v[_]=n>>>24^A<<8,this.v[_+1]=A>>>24^n<<8,this.ADD64AA(this.v,t,_),this.ADD64AC(this.v,t,r,a),n=this.v[e]^this.v[t],A=this.v[e+1]^this.v[t+1],this.v[e]=n>>>16^A<<16,this.v[e+1]=A>>>16^n<<16,this.ADD64AA(this.v,$,e),n=this.v[_]^this.v[$],A=this.v[_+1]^this.v[$+1],this.v[_]=A>>>31^n<<1,this.v[_+1]=n>>>31^A<<1}blake2bCompress(t,_){let $=0;for($=0;$<16;$++)this.v[$]=t.h[$],this.v[$+16]=this.BLAKE2B_IV32[$];for(this.v[24]=this.v[24]^t.t,this.v[25]=this.v[25]^t.t/4294967296,_&&(this.v[28]=~this.v[28],this.v[29]=~this.v[29]),$=0;$<32;$++)this.m[$]=this.B2B_GET32(t.b,4*$);for($=0;$<12;$++)this.B2B_G(0,8,16,24,this.SIGMA82[16*$+0],this.SIGMA82[16*$+1]),this.B2B_G(2,10,18,26,this.SIGMA82[16*$+2],this.SIGMA82[16*$+3]),this.B2B_G(4,12,20,28,this.SIGMA82[16*$+4],this.SIGMA82[16*$+5]),this.B2B_G(6,14,22,30,this.SIGMA82[16*$+6],this.SIGMA82[16*$+7]),this.B2B_G(0,10,20,30,this.SIGMA82[16*$+8],this.SIGMA82[16*$+9]),this.B2B_G(2,12,22,24,this.SIGMA82[16*$+10],this.SIGMA82[16*$+11]),this.B2B_G(4,14,16,26,this.SIGMA82[16*$+12],this.SIGMA82[16*$+13]),this.B2B_G(6,8,18,28,this.SIGMA82[16*$+14],this.SIGMA82[16*$+15]);for($=0;$<16;$++)t.h[$]=t.h[$]^this.v[$]^this.v[$+16]}blake2bInit(t,_,$,e){if(0===t||t>64)throw Error("Illegal output length, expected 0 < length <= 64");if(_&&_.length>64)throw Error("Illegal key, expected Uint8Array with 0 < length <= 64");if($&&16!==$.length)throw Error("Illegal salt, expected Uint8Array with length is 16");if(e&&16!==e.length)throw Error("Illegal personal, expected Uint8Array with length is 16");let i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};this.parameterBlock.fill(0),this.parameterBlock[0]=t,_&&(this.parameterBlock[1]=_.length),this.parameterBlock[2]=1,this.parameterBlock[3]=1,$&&this.parameterBlock.set($,32),e&&this.parameterBlock.set(e,48);for(let h=0;h<16;h++)i.h[h]=this.BLAKE2B_IV32[h]^this.B2B_GET32(this.parameterBlock,4*h);return _&&(this.blake2bUpdate(i,_),i.c=128),i}blake2bUpdate(t,_){for(let $=0;$<_.length;$++)128===t.c&&(t.t+=t.c,this.blake2bCompress(t,!1),t.c=0),t.b[t.c++]=_[$]}blake2bFinal(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;this.blake2bCompress(t,!0);let _=new Uint8Array(t.outlen);for(let $=0;$<t.outlen;$++)_[$]=t.h[$>>2]>>8*(3&$);return _}blake2bStart(t,_,$,e,i){$=$||64,t=this.normalizeInput(t),e&&(e=this.normalizeInput(e)),i&&(i=this.normalizeInput(i));let h=this.blake2bInit($,_,e,i);return this.blake2bUpdate(h,t),this.blake2bFinal(h)}blake2bHex(t,_,$,e,i){let h=blake2bStart(t,_,$,e,i);return toHex(h)}normalizeInput(t){let _;if(t instanceof Uint8Array)_=t;else if("string"==typeof t){let $=new TextEncoder;_=$.encode(t)}else throw Error("Input must be an string, Buffer or Uint8Array");return _}toHex(t){return Array.prototype.map.call(t,function(t){return(t<16?"0":"")+t.toString(16)}).join("")}static hash(t,_,$=64,e,i){let h=new Blake2b,s=h.blake2bStart(t,_,$,e,i);return h.toHex(s)}}
/*
Argon2id-JS v1.0.0
https://github.com/Rabbit-Company/Argon2id-JS
License: GPL-3.0
*/
class Argon2id{construtor(){this.mm=NaN,this.H_0=NaN,this.p=NaN,this.q=NaN}LE32(t){let e=new Uint8Array(4);return e[0]=t,e[1]=t>>8&255,e[2]=t>>16&255,e[3]=t>>24&255,Array.from(e)}LE64(t){let e=new Uint8Array(8);return e[0]=t,e[1]=t>>8&255,e[2]=t>>16&255,e[3]=t>>24&255,Array.from(e)}toHex(t){return Array.prototype.map.call(t,function(t){return(t<16?"0":"")+t.toString(16)}).join("")}ascii(t){for(var e=[],i=0,n=t.length;i<n;i++){var s=Number(t.charCodeAt(i));e.push(s)}return e}extract(t,e){return 0==e?this.Uint8ArrayToBigInt(t.slice(0,4)):1==e?this.Uint8ArrayToBigInt(t.slice(4,8)):void 0}NumberToUint8Array=t=>{var e=[],i=BigInt(t);for(let n=0;n<Math.ceil(Math.floor(Math.log2(new Number(t))+1)/8);n++)e.unshift(new Number(i>>BigInt(8*n)&255n));return new Uint8Array(e).reverse()};Uint8ArrayToBigInt=t=>[...t].reduce((t,e,i)=>BigInt(t)|BigInt(e)<<BigInt(8*i));ZERO(t){return new Uint8Array(t).fill(0)}Concatenate(t,e,i=""){return new Uint8Array([...t,...e,...i])}XOR(t,e){let i=new Uint8Array(1024);for(let n=0;n<t.length;n++)i[n]=t[n]^e[n];return i}MOD(t,e){return(t%e+e)%e}GB(t,e,i,n){let s=2n**64n-1n,a=BigInt(4294967295),h=n^(t=t+e+BigInt(2)*(t&a)*(e&a)&BigInt.asUintN(64,s));return t=t+(e=(h=e^(i=i+(n=h>>BigInt(32)|(h&a)<<BigInt(32))+BigInt(2)*(i&a)*(n&a)&BigInt.asUintN(64,s)))>>BigInt(24)|(h&BigInt(16777215))<<BigInt(40))+BigInt(2)*(t&a)*(e&a)&BigInt.asUintN(64,s),e=(h=e^(i=i+(n=(h=n^t)>>BigInt(16)|(h&BigInt(65535))<<BigInt(48))+BigInt(2)*(i&a)*(n&a)&BigInt.asUintN(64,s)))>>BigInt(63)|h<<BigInt(1)&BigInt.asUintN(64,s),[t,e,i,n]}P(t,e,i,n,s,a,h,r){let l,o=this.Uint8ArrayToBigInt(t.slice(0,8)),c=this.Uint8ArrayToBigInt(t.slice(8,16)),g=this.Uint8ArrayToBigInt(e.slice(0,8)),$=this.Uint8ArrayToBigInt(e.slice(8,16)),_=this.Uint8ArrayToBigInt(i.slice(0,8)),u=this.Uint8ArrayToBigInt(i.slice(8,16)),C=this.Uint8ArrayToBigInt(n.slice(0,8)),A=this.Uint8ArrayToBigInt(n.slice(8,16)),b=this.Uint8ArrayToBigInt(s.slice(0,8)),f=this.Uint8ArrayToBigInt(s.slice(8,16)),U=this.Uint8ArrayToBigInt(a.slice(0,8)),E=this.Uint8ArrayToBigInt(a.slice(8,16)),y=this.Uint8ArrayToBigInt(h.slice(0,8)),T=this.Uint8ArrayToBigInt(h.slice(8,16)),m=this.Uint8ArrayToBigInt(r.slice(0,8)),p=this.Uint8ArrayToBigInt(r.slice(8,16)),d=this.GB(o,_,b,y);return o=d[0],_=d[1],b=d[2],y=d[3],c=(d=this.GB(c,u,f,T))[0],u=d[1],f=d[2],T=d[3],g=(d=this.GB(g,C,U,m))[0],C=d[1],U=d[2],m=d[3],$=(d=this.GB($,A,E,p))[0],A=d[1],E=d[2],p=d[3],o=(d=this.GB(o,u,U,p))[0],u=d[1],U=d[2],p=d[3],c=(d=this.GB(c,C,E,y))[0],C=d[1],E=d[2],y=d[3],g=(d=this.GB(g,A,b,T))[0],A=d[1],b=d[2],T=d[3],$=(d=this.GB($,_,f,m))[0],_=d[1],f=d[2],m=d[3],o=this.NumberToUint8Array(o),c=this.NumberToUint8Array(c),g=this.NumberToUint8Array(g),$=this.NumberToUint8Array($),_=this.NumberToUint8Array(_),u=this.NumberToUint8Array(u),C=this.NumberToUint8Array(C),A=this.NumberToUint8Array(A),b=this.NumberToUint8Array(b),f=this.NumberToUint8Array(f),U=this.NumberToUint8Array(U),E=this.NumberToUint8Array(E),y=this.NumberToUint8Array(y),T=this.NumberToUint8Array(T),m=this.NumberToUint8Array(m),p=this.NumberToUint8Array(p),o.length<8&&(l=8-o.length,o=this.Concatenate(o,this.ZERO(l))),c.length<8&&(l=8-c.length,c=this.Concatenate(c,this.ZERO(l))),g.length<8&&(l=8-g.length,g=this.Concatenate(g,this.ZERO(l))),$.length<8&&(l=8-$.length,$=this.Concatenate($,this.ZERO(l))),_.length<8&&(l=8-_.length,_=this.Concatenate(_,this.ZERO(l))),u.length<8&&(l=8-u.length,u=this.Concatenate(u,this.ZERO(l))),C.length<8&&(l=8-C.length,C=this.Concatenate(C,this.ZERO(l))),A.length<8&&(l=8-A.length,A=this.Concatenate(A,this.ZERO(l))),b.length<8&&(l=8-b.length,b=this.Concatenate(b,this.ZERO(l))),f.length<8&&(l=8-f.length,f=this.Concatenate(f,this.ZERO(l))),U.length<8&&(l=8-U.length,U=this.Concatenate(U,this.ZERO(l))),E.length<8&&(l=8-E.length,E=this.Concatenate(E,this.ZERO(l))),y.length<8&&(l=8-y.length,y=this.Concatenate(y,this.ZERO(l))),T.length<8&&(l=8-T.length,T=this.Concatenate(T,this.ZERO(l))),m.length<8&&(l=8-m.length,m=this.Concatenate(m,this.ZERO(l))),p.length<8&&(l=8-p.length,p=this.Concatenate(p,this.ZERO(l))),t=this.Concatenate(o,c),e=this.Concatenate(g,$),i=this.Concatenate(_,u),n=this.Concatenate(C,A),s=this.Concatenate(b,f),a=this.Concatenate(U,E),[t,e,i,n,s,a,h=this.Concatenate(y,T),r=this.Concatenate(m,p)]}G(t,e){let i=this.XOR(t,e),n=[],s,a,h;for(let r=0;r<8;r++){a=128*r,s=this.P(i.slice(a,a+16),i.slice(a+16,a+32),i.slice(a+32,a+48),i.slice(a+48,a+64),i.slice(a+64,a+80),i.slice(a+80,a+96),i.slice(a+96,a+112),i.slice(a+112,a+128));for(let l=0;l<s.length;l++)n=this.Concatenate(n,s[l])}let o=[];for(let c=0;c<8;c++){a=16*c,s=this.P(n.slice(a,a+16),n.slice(a+128,a+128+16),n.slice(a+256,a+256+16),n.slice(a+384,a+384+16),n.slice(a+512,a+512+16),n.slice(a+640,a+640+16),n.slice(a+768,a+768+16),n.slice(a+896,a+896+16));for(let g=0;g<s.length;g++)o=this.Concatenate(o,s[g])}let $=[];for(let _=0;_<8;_++)a=16*_,h=this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(o.slice(a,a+16),o.slice(a+128,a+128+16)),o.slice(a+256,a+256+16)),o.slice(a+384,a+384+16)),o.slice(a+512,a+512+16)),o.slice(a+640,a+640+16)),o.slice(a+768,a+768+16)),o.slice(a+896,a+896+16)),$=this.Concatenate($,h);return this.XOR($,i)}blake2bSetup(t,e=null){this.context=new Blake2b().blake2bInit(t,e)}Argon2Operation(t,e,i,n,s,a,h,r,l="",o=""){this.H_0=this.EstablishH_0(t,e,i,n,s,a,h,r,l,o),this.AllocateMemory(t,i),this.p=t,this.q=this.mm/this.p;var c=this.q/4;let g=Array(this.p);for(let $=0;$<this.p;$++)g[$]=Array(this.q);for(let _=0;_<n;_++)for(let u=0;u<4;u++){var C=Array(t);for(let A=0;A<t;A++)C[A]=this._fill_segment(g,_,u,A,a,c,this.H_0,this.q,t,this.mm,n,s);for(let b=0;b<t;b++){var f=C[b];for(let U=0;U<c;U++)g[b][u*c+U]=f[U]}}let E=this.ZERO(1024);for(let y=0;y<t;y++)E=this.XOR(E,g[y][this.q-1]);return this.variableLengthHashFunction(e,E)}EstablishH_0(t,e,i,n,s,a,h,r,l="",o=""){var c=this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.LE32(t),this.LE32(e)),this.LE32(i)),this.LE32(n)),this.LE32(s)),this.LE32(a)),g=this.Concatenate(this.LE32(h.length),this.ascii(h)),$=this.Concatenate(this.LE32(r.length),this.ascii(r)),_=this.Concatenate(this.LE32(l.length),this.ascii(l));let u=this.Concatenate(this.LE32(o.length),this.ascii(o));var C=this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(c,g),$),_),u);return this.blake2bSetup(64),new Blake2b().blake2bUpdate(this.context,C),new Blake2b().blake2bFinal(this.context)}AllocateMemory(t,e){this.mm=4*t*Math.floor(e/(4*t))}variableLengthHashFunction(t,e){if(t<=64)return this.blake2bSetup(t),n=this.Concatenate(this.LE32(t),e),new Blake2b().blake2bUpdate(this.context,n),new Blake2b().blake2bFinal(this.context);var i=Math.ceil(t/32)-2,n=this.Concatenate(this.LE32(t),e);this.blake2bSetup(64),new Blake2b().blake2bUpdate(this.context,n);var s=new Blake2b().blake2bFinal(this.context),a=s.slice(0,32);for(let h=2;h<=i;h++)this.blake2bSetup(64),new Blake2b().blake2bUpdate(this.context,s),s=new Blake2b().blake2bFinal(this.context),a=this.Concatenate(a,s.slice(0,32));return this.blake2bSetup(t-32*i),new Blake2b().blake2bUpdate(this.context,s),s=new Blake2b().blake2bFinal(this.context),this.Concatenate(a,s)}_fill_segment(t,e,i,n,s,a,h,r,l,o,c,g){var $=1==s||2==s&&0==e&&i<=1;if($)for(var _=[],u=0;_.length<a;){u+=1;var C=this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.Concatenate(this.LE64(e),this.LE64(n)),this.LE64(i)),this.LE64(o)),this.LE64(c)),this.LE64(s)),this.LE64(u)),this.ZERO(968)),A=this.G(this.ZERO(1024),this.G(this.ZERO(1024),C));for(let b=0;b<1024;b+=8)_.push([this.Uint8ArrayToBigInt(A.slice(b,b+4)),this.Uint8ArrayToBigInt(A.slice(b+4,b+8))])}for(let f=0;f<a;f++){var U=i*a+f;if(0==e&&U<2){t[n][U]=this.variableLengthHashFunction(1024,this.Concatenate(this.H_0,this.LE32(U),this.LE32(n)));continue}var E=NaN,y=NaN;$?(E=_[f][0],y=_[f][1]):(E=this.extract(t[n][this.MOD(U-1,r)],0),y=this.extract(t[n][this.MOD(U-1,r)],1));var T=NaN;T=0==e&&0==i?n:this.MOD(y,BigInt(l));var m=NaN;m=0==e?0==i||n==T?U-1:0==f?i*a-1:i*a:n==T?r-a+f-1:0==f?r-a-1:r-a;var p=E**BigInt(2)>>BigInt(32);p=BigInt(m)-BigInt(1)-(BigInt(m)*p>>BigInt(32));var d=0;0!=e&&3!=i&&(d=(i+1)*a);var O=this.MOD(BigInt(d)+p,BigInt(r)),R=this.G(t[n][this.MOD(U-1,r)],t[T][O]);0!=e&&19==g&&(R=this.XOR(t[n][U],R)),t[n][U]=R}return t[n].slice(i*a,(i+1)*a)}hexToBase64(t){return btoa(t.match(/\w{2}/g).map(function(t){return String.fromCharCode(parseInt(t,16))}).join(""))}base64ToHex(t){let e=atob(t),i="";for(let n=0;n<e.length;n++){let s=e.charCodeAt(n).toString(16);i+=2===s.length?s:"0"+s}return i.toUpperCase()}randRange(t,e){var i=e-t,n=Math.ceil(Math.log2(i)/8);if(!n)return t;for(var s=Math.pow(256,n),a=new Uint8Array(n);;){window.crypto.getRandomValues(a);for(var h=0,r=0;r<n;r++)h=(h<<8)+a[r];if(h<s-s%i)return t+h%i}}static randomSalt(){let t=new Argon2id,e="abcdefghijklmnopqrstuvwxyz",i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="1234567890",s="";for(let a=0;a<16;a++)s+=e.charAt(t.randRange(0,e.length));s=s.split("");for(let h=0;h<8;h++)s[t.randRange(0,s.length)]=i.charAt(t.randRange(0,i.length));for(let r=0;r<8;r++)s[t.randRange(0,s.length)]=n.charAt(t.randRange(0,n.length));return s.join("")}static hash(t,e=Argon2id.randomSalt(),i=2,n=32,s=3,a=32,h="",r=""){let l=new Argon2id,o=l.Argon2Operation(s,a,n,i,19,2,t,e,h,r);return l.toHex(o)}static hashDecode(t){let e=new Argon2id,i=t.split("$")[5];return e.base64ToHex(i).toLowerCase()}static hashEncoded(t,e=Argon2id.randomSalt(),i=2,n=32,s=3,a=32,h="",r=""){let l=new Argon2id,o=l.Argon2Operation(s,a,n,i,19,2,t,e,h,r);return"$argon2id$v=19$m="+n+",t="+i+",p="+s+"$"+btoa(e).replaceAll("=","")+"$"+l.hexToBase64(l.toHex(o)).replaceAll("=","")}static verify(t,e,i="",n=""){let s=t.split("$");if(6!=s.length||"argon2id"!=s[1]||"v=19"!=s[2])return!1;let a=s[3].split(",");if(3!=a.length)return!1;let h=a[0].split("=")[1],r=a[1].split("=")[1],l=a[2].split("=")[1],o=atob(s[4]),c=Argon2id.hashDecode(t),g=Argon2id.hash(e,o,r,h,l,c.length/2,i,n);return c==g}}